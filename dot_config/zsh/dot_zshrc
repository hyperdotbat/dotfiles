# main zsh settings. env in ~/.zprofile
# read second

[ -f "$XDG_CONFIG_HOME/shell/aliases.sh" ] && source "$XDG_CONFIG_HOME/shell/aliases.sh"
[ -f "$XDG_CONFIG_HOME/shell/aliases-arch.sh" ] && source "$XDG_CONFIG_HOME/shell/aliases-arch.sh"
[ -f "$XDG_CONFIG_HOME/shell/aliases_$(uname -n).sh" ] && source "$XDG_CONFIG_HOME/shell/aliases_$(uname -n).sh"

zmodload zsh/complist
autoload -U compinit && compinit
autoload -U colors && colors

# prompt | vsc (git) integration
autoload -Uz vcs_info
# only show branch name
zstyle ':vcs_info:git:*' formats '%b'
zstyle ':vcs_info:git:*' actionformats '%b' #|%a'
precmd() { vcs_info }
setopt prompt_subst

#PROMPT=$'\n''%F{blue}%n@%m %F{green}%~ %F{red}$vcs_info_msg_0_ %F{cyan}➜%f '
PROMPT=$'\n'$'%F{240}[%F{2}%n%F{6}@%F{4}%m%F{240}] %F{3}%~ %F{13}$vcs_info_msg_0_\n%F{1}λ%f '

# cmp opts
zstyle ':completion:*' menu select # tab opens cmp menu
zstyle ':completion:*' special-dirs true # force . and .. to show in cmp menu
if [ -f /usr/share/dircolors/dircolors.256color ]; then
    eval "$(dircolors -b /usr/share/dircolors/dircolors.256color)"
fi
zstyle ':completion:*' list-colors ${(s.:.)LS_COLORS} ma=0\;33 # colorize cmp menu
#zstyle ':completion:*' file-list true # more detailed list
zstyle ':completion:*' squeeze-slashes false # explicit disable to allow /*/ expansion

setopt append_history inc_append_history share_history # better history
# on exit, history appends rather than overwrites; history is appended as soon as cmds executed; history shared across sessions
setopt auto_menu menu_complete # autocmp first menu match
setopt autocd # type a dir to cd
setopt auto_param_slash # when a dir is completed, add a / instead of a trailing space
setopt no_case_glob no_case_match # make cmp case insensitive
setopt globdots # include dotfiles
setopt extended_glob # match ~ # ^
setopt interactive_comments # allow comments in shell
unsetopt prompt_sp # dont autoclean blanklines
stty stop undef # disable accidental ctrl s ?


HISTSIZE=1000000
SAVEHIST=1000000
HISTFILE="$XDG_CACHE_HOME/zsh_history"
HISTCONTROL=ignoreboth

# ctrl+r use fzf
source <(fzf --zsh)


openranger(){
    ranger <$TTY
    zle redisplay
}
zle -N openranger
bindkey '^f' openranger

# idk if this works
if [[ -n "$SSH_CONNECTION" && -z $TMUX ]]; then
    bind '"\C-d": "exit\015"'  # Bind Ctrl+D to 'exit' in tmux
fi

bindkey -e
bindkey '^[[H' beginning-of-line  # Home
bindkey '^[[F' end-of-line        # End
bindkey '^[[1~' beginning-of-line # alternative Home
bindkey '^[[4~' end-of-line       # alternative End
bindkey '^[[3~' delete-char
bindkey '^k' kill-line

# requires zsh-autosuggestions package
[ -f "/usr/share/zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh" ] && source "/usr/share/zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh"
# requires zsh-syntax-highlighting package
[ -f "/usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh" ] && source "/usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh"

# fastfetch on start :)
[ -f "$XDG_CONFIG_HOME/shell/fetch.sh" ] && source "$XDG_CONFIG_HOME/shell/fetch.sh" 
~/.local/scripts/arch_update_reminder.sh
